
   
SELECT YearTerm, 
       COUNT(*) AS total,
       ROUND(COUNT(CASE WHEN grade IN ('A', 'B', 'C') THEN 1 ELSE NULL END) / COUNT(*)::numeric, 2) AS pass_rate
FROM edw.StudentCourseGradeDetailFlat 
GROUP BY YearTerm


