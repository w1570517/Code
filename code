
select  student_id, YearTerm, grade,
count ( case   when  grade  in   ( 'A' ,  'B' ,  'C' )   then   1   end )  /  count ( * )  as  pass_rate
 from  edw.StudentCourseGradeDetailFlat 

   group   by student_id, YearTerm, grade
